<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="utf-8" />
        <title>Group_Table</title>
        <script type="text/javascript" src="jquery-1.10.0.min.js"></script>

<!--Стили таблиц и кнопок-->
<style type="text/css">
.tab01 {table-layout: fixed;
        width: 50%;
        border-collapse:collapse;
        background-color: #FFFF00;    
        font-size: 18pt;}
       
  .tab01 th {background-color: #DEB887;
         border:2px solid #000000;
         padding:0;
         width:200px;}
  .tab01 td {border:2px solid #000000;      
         padding:0;
         width:200px;}  
.tab01 td p {overflow: hidden;
         margin:0;
         padding:2px 4px;
}
.tab01 td p:focus {outline:1px solid #4D90FE;}
        
  .tab02 {table-layout: fixed;
         width:200px;
         border-collapse:collapse;
         background-color: #C0C0C0;    
         font-size: 18pt;
}
  
  .tab02 th {background-color: #DEB887;
border:1px solid #000000;
         border-left:2px solid #000000;
         border-rigth:2px solid #000000;
         overflow: hidden;
         padding:0;
         width:200px;}


  .tab02 td {border:1px solid #000000;
         border-left:2px solid #000000;
         border-rigth:2px solid #000000;
         overflow: hidden;
         padding:0;
         width:200px;}



 .www {width: 200px;            
        font-size: 16pt;}  

 .sp01 {            
         font-size: 16pt;}    
 .sp02 {width:165px;            
         font-size: 13pt;}	
	  </style>   
</head>


<body>
<!--Таблица исходная--> 
<table id="myTable" class="tab01" >
  <tr>  <th>А</th>   <th>B</th>    <th>C</th>    <th>D</th>   <th>E</th>   </tr>
  <tr> <td>100</td>  <td>40</td>   <td>10</td>   <td>1</td>   <td>20</td>  </tr>
  <tr> <td>200</td>  <td>41</td>   <td>11</td>   <td>2</td>   <td>21</td>  </tr>
  <tr> <td>300</td>  <td>42</td>   <td>12</td>   <td>3</td>   <td>22</td>  </tr>
  <tr> <td>400</td>  <td>43</td>   <td>13</td>   <td>4</td>   <td>23</td>  </tr>
  <tr> <td>500</td>  <td>44</td>   <td>14</td>   <td>5</td>   <td>24</td>  </tr>
  <tr> <td>600</td>  <td>45</td>   <td>15</td>   <td>6</td>   <td>25</td>  </tr>
  <tr> <td>700</td>  <td>46</td>   <td>16</td>   <td>7</td>   <td>26</td>  </tr>
  <tr> <td>800</td>  <td>47</td>   <td>17</td>   <td>8</td>   <td>27</td>  </tr>
  <tr> <td>900</td>  <td>48</td>   <td>18</td>   <td>9</td>   <td>28</td>  </tr>
  <tr> <td>1000</td> <td>49</td>   <td>19</td>   <td>1</td>   <td>29</td>  </tr>
  <tr> <td>1100</td> <td>49</td>   <td>19</td>   <td>1</td>   <td>29</td>  </tr>
  <tr> <td>1200</td>  <td>42</td>   <td>12</td>   <td>3</td>   <td>22</td>  </tr>
  <tr> <td>1300</td>  <td>42</td>   <td>12</td>   <td>3</td>   <td>22</td>  </tr>
  <tr> <td>1400</td>  <td>47</td>   <td>15</td>   <td>4</td>   <td>26</td>  </tr>
</table>




<!--Выпадающий список--> 
<form name="f1" class="sp01">
A:
<select name="Spisok A" id="s1" class="sp02">
  <option value="1">Сумма</option>
  <option value="2">Макс</option>
  <option value="3">Мин</option>
  <option value="4">Конкат</option>
  <option value="5">-----</option>
  <option value="6">Критер</option>
</select>


<form name="f2" class="sp01">
B:
<select name="Spisok B" id="s2" class="sp02">
  <option value="1">Сумма</option>
  <option value="2">Макс</option>
  <option value="3">Мин</option>
  <option value="4">Конкат</option>
  <option value="5">-----</option>
  <option value="6">Критер</option>
</select>


<form name="f3" class="sp01">
C:
<select name="Spisok C" id="s3" class="sp02">
  <option value="1">Сумма</option>
  <option value="2">Макс</option>
  <option value="3">Мин</option>
  <option value="4">Конкат</option>
  <option value="5">-----</option>
  <option value="6">Критер</option>
</select>


<form name="f4" class="sp01">
D:
<select name="Spisok D" id="s4" class="sp02">
  <option value="1">Сумма</option>
  <option value="2">Макс</option>
  <option value="3">Мин</option>
  <option value="4">Конкат</option>
  <option value="5">-----</option>
  <option value="6">Критер</option>
</select>


<form name="f5" class="sp01">
E:
<select name="Spisok E" id="s5" class="sp02">
  <option value="1">Сумма</option>
  <option value="2">Макс</option>
  <option value="3">Мин</option>
  <option value="4">Конкат</option>
  <option value="5">-----</option>
  <option value="6">Критер</option>
</select>


<!--Кнопка сгруппировать--> 
 <input type="button" onclick="Group1()" value="Сгруппировать"  id="1" class="www">
</form>

<!--Для итоговых таблиц--> 
<div id="res11"></div>

<!---Для коррект данных ячеек-->
<body onload="kor('myTable')">





<script language="javascript" type="text/javascript">

<!---Функция коррект данных ячеек-->
function kor(znach) 
{
  var tbl = document.getElementById(znach);
  for (i=1; i<tbl.rows.length; i++) 
{
    var row = tbl.rows[i];
    for (j=0; j<row.cells.length; j++)
 {
      var td = row.cells[i,j];
      td.innerHTML = '<p tabindex="-1" contenteditable="true">' + td.innerHTML + '</p>';
    }
  }
}




<!---Функция по нажатию кнопки-->
function Group1() 
{
<!--Забираем значения селекторов--> 
var w1=document.getElementById('s1').value;
var w2=document.getElementById('s2').value;
var w3=document.getElementById('s3').value;
var w4=document.getElementById('s4').value;
var w5=document.getElementById('s5').value;



<!--Забираем значения ячеек из исходной таблицы--> 
var TableList = new Array();                    
var tr = document.getElementById("myTable").getElementsByTagName("tr");
    for(var i=0;i<tr.length;i++){var td = tr.item(i).getElementsByTagName("td");
                                 TableList[i] = new Array();
                                 for(var j=0;j<td.length;j++){TableList[i][j] = td.item(j).innerText;};}; 

row= TableList.length-1;col=5;
var t = new Array(row);for(var i = 0; i < col; i++){t[i] = new Array(row);}
for(var i = 0; i < col; i++){for(var j = 0; j < row; j++) { t[i][j]=TableList[++j][i];--j}}

var ar1=t[0];
var ar2=t[1];
var ar3=t[2];
var ar4=t[3];
var ar5=t[4];

for(var i = 0; i < row; i++){if ((w1 == 1) || (w1 == 2) || (w1 == 3)) {ar1[i]=+ar1[i];} 
                             if ((w2 == 1) || (w2 == 2) || (w2 == 3)) {ar2[i]=+ar2[i];}
                             if ((w3 == 1) || (w3 == 2) || (w3 == 3)) {ar3[i]=+ar3[i];} 
                             if ((w4 == 1) || (w4 == 2) || (w4 == 3)) {ar4[i]=+ar4[i];}
                             if ((w5 == 1) || (w5 == 2) || (w5 == 3)) {ar5[i]=+ar5[i];};}

for(var i=0;i<ar1.length;i++){	
if (  (/[^[0-9]/.test(ar1[i])) &&   ((w1 == 1) || (w1 == 2) || (w1 == 3))  ){alert('В столбец А не введено число');}
if (  (/[^[0-9]/.test(ar2[i])) &&   ((w2 == 1) || (w2 == 2) || (w2 == 3))  ){alert('В столбец B не введено число');}
if (  (/[^[0-9]/.test(ar3[i])) &&   ((w3 == 1) || (w3 == 2) || (w3 == 3))  ){alert('В столбец C не введено число');}
if (  (/[^[0-9]/.test(ar4[i])) &&   ((w4 == 1) || (w4 == 2) || (w4 == 3))  ){alert('В столбец D не введено число');}
if (  (/[^[0-9]/.test(ar5[i])) &&   ((w5 == 1) || (w5 == 2) || (w5 == 3))  ){alert('В столбец E не введено число');}
};


if ((w1 != 6) && (w2 != 6) && (w3 != 6) && (w4 != 6) && (w5 != 6)) {xr1=0; alert("Выберите критерий!")} else {xr1=1};

if (xr1 == 1){ 
<!--Группировка, например, n строк по 5 критериям  -->
var n = ar1.length, k1 = 0, k2 = 0, k3 = 0, k4 = 0, k5 = 0;
A1 = [], B1 = [], C1 = [], D1 = [], E1 = [];
SumA = [];SumB = [];SumC = [];SumD = [];SumE = [];
MaxA = [];MaxB = [];MaxC = [];MaxD = [];MaxE = [];
MinA = [];MinB = [];MinC = [];MinD = [];MinE = []; 
    
for (var i = 0; i < n; i++) {var j = 0; while ((j < k1) &&
((A1[j] !== ar1[i])&&(w1==6) ||
 (B1[j] !== ar2[i])&&(w2==6) ||
 (C1[j] !== ar3[i])&&(w3==6) ||
 (D1[j] !== ar4[i])&&(w4==6) ||
 (E1[j] !== ar5[i])&&(w5==6))){j++;}; 

if (((w1==1)||(w1==4))&&
 ((B1[j] !== ar2[i]&&(w2==6)||(w2!=6)) && 
  (C1[j] !== ar3[i]&&(w3==6)||(w3!=6)) &&
  (D1[j] !== ar4[i]&&(w4==6)||(w4!=6)) &&
  (E1[j] !== ar5[i]&&(w5==6)||(w5!=6)))){SumA[j] = ar1[i];} else{SumA[j] = SumA[j]+ar1[i];}
 
if (((w2==1)||(w2==4))&&
 ((A1[j] !== ar1[i]&&(w1==6)||(w1!=6)) && 
  (C1[j] !== ar3[i]&&(w3==6)||(w3!=6)) &&
  (D1[j] !== ar4[i]&&(w4==6)||(w4!=6)) &&
  (E1[j] !== ar5[i]&&(w5==6)||(w5!=6)))){SumB[j] = ar2[i];} else{SumB[j] = SumB[j]+ar2[i];}

if (((w3==1)||(w3==4))&&
 ((A1[j] !== ar1[i]&&(w1==6)||(w1!=6)) && 
  (B1[j] !== ar2[i]&&(w2==6)||(w2!=6)) &&
  (D1[j] !== ar4[i]&&(w4==6)||(w4!=6)) &&
  (E1[j] !== ar5[i]&&(w5==6)||(w5!=6)))){SumC[j] = ar3[i];} else{SumC[j] = SumC[j]+ar3[i];}

if (((w4==1)||(w4==4))&&
 ((A1[j] !== ar1[i]&&(w1==6)||(w1!=6)) && 
  (B1[j] !== ar2[i]&&(w2==6)||(w2!=6)) &&
  (C1[j] !== ar3[i]&&(w3==6)||(w3!=6)) &&
  (E1[j] !== ar5[i]&&(w5==6)||(w5!=6)))){SumD[j] = ar4[i];} else{SumD[j] = SumD[j]+ar4[i];}

if ( ((w5==1)||(w5==4))&&
 ((A1[j] !== ar1[i]&&(w1==6)||(w1!=6)) && 
  (B1[j] !== ar2[i]&&(w2==6)||(w2!=6)) &&
  (C1[j] !== ar3[i]&&(w3==6)||(w3!=6)) &&
  (D1[j] !== ar4[i]&&(w4==6)||(w4!=6)))){SumE[j] = ar5[i];} else{SumE[j] = SumE[j]+ar5[i];}

if (((w1==2)||(w1==3))&&
 ((B1[j] !== ar2[i]&&(w2==6)||(w2!=6)) && 
  (C1[j] !== ar3[i]&&(w3==6)||(w3!=6)) &&
  (D1[j] !== ar4[i]&&(w4==6)||(w4!=6)) &&
  (E1[j] !== ar5[i]&&(w5==6)||(w5!=6)))){MaxA[j] = ar1[i];MinA[j] = ar1[i];} else{if(MaxA[j]<ar1[i]) {MaxA[j] = ar1[i]} else{MinA[j] = ar1[i]} };

if (((w2==2)||(w2==3))&&
 ((A1[j] !== ar1[i]&&(w1==6)||(w1!=6)) && 
  (C1[j] !== ar3[i]&&(w3==6)||(w3!=6)) &&
  (D1[j] !== ar4[i]&&(w4==6)||(w4!=6)) &&
  (E1[j] !== ar5[i]&&(w5==6)||(w5!=6)))){MaxB[j] = ar2[i];MinB[j] = ar2[i];} else{if(MaxB[j]<ar2[i]) {MaxB[j] = ar2[i]} else{MinB[j] = ar2[i]};};

if (((w3==2)||(w3==3))&&
  ((A1[j] !== ar1[i]&&(w1==6)||(w1!=6)) && 
   (B1[j] !== ar2[i]&&(w2==6)||(w2!=6)) &&
   (D1[j] !== ar4[i]&&(w4==6)||(w4!=6)) &&
   (E1[j] !== ar5[i]&&(w5==6)||(w5!=6)))){MaxC[j] = ar3[i];MinC[j] = ar3[i];} else{if(MaxC[j]<ar3[i]) {MaxC[j] = ar3[i]} else{MinC[j] = ar3[i]};};

if ( ((w4==2)||(w4==3))&&
  ((A1[j] !== ar1[i]&&(w1==6)||(w1!=6)) && 
   (B1[j] !== ar2[i]&&(w2==6)||(w2!=6)) &&
   (C1[j] !== ar3[i]&&(w3==6)||(w3!=6)) &&
   (E1[j] !== ar5[i]&&(w5==6)||(w5!=6)))){MaxD[j] = ar4[i];MinD[j] = ar4[i];} else {if(MaxD[j]<ar4[i]) {MaxD[j] = ar4[i]} else{MinD[j] = ar4[i]};};

if (((w5==2)||(w5==3))&&
  ((A1[j] !== ar1[i]&&(w1==6)||(w1!=6)) && 
   (B1[j] !== ar2[i]&&(w2==6)||(w2!=6)) &&
   (C1[j] !== ar3[i]&&(w3==6)||(w3!=6)) &&
   (D1[j] !== ar4[i]&&(w4==6)||(w4!=6)))){MaxE[j] = ar5[i];MinE[j] = ar5[i];} else {if(MaxE[j]<ar5[i]) {MaxE[j] = ar5[i]} else{MinE[j] = ar5[i]};};



if (j == k1) {A1[k1++] = ar1[ i ];
              B1[k2++] = ar2[ i ];
              C1[k3++] = ar3[ i ];
              D1[k4++] = ar4[ i ];
              E1[k5++] = ar5[ i ];};};};
  
dl=A1.length || B1.length || C1.length || D1.length || D1.length;

for (var i=0;i<dl;i++){for (var j=1;j<2;j++){if((w1==j)||(w1==4)){A1[i]=SumA[i];};
                                                     if((w2==j)||(w2==4)){B1[i]=SumB[i];};
                                                     if((w3==j)||(w3==4)){C1[i]=SumC[i];};
                                                     if((w4==j)||(w4==4)){D1[i]=SumD[i];};
                                                     if((w5==j)||(w5==4)){E1[i]=SumE[i];};};};

for (var i=0;i<dl;i++){for (var j=2;j<3;j++){if((w1==j)){A1[i]=MaxA[i];};
                                             if((w2==j)){B1[i]=MaxB[i];};
                                             if((w3==j)){C1[i]=MaxC[i];};
                                             if((w4==j)){D1[i]=MaxD[i];};
                                             if((w5==j)){E1[i]=MaxE[i];};};};

for (var i=0;i<dl;i++){for (var j=3;j<4;j++){if((w1==j)){A1[i]=MinA[i];};
                                             if((w2==j)){B1[i]=MinB[i];};
                                             if((w3==j)){C1[i]=MinC[i];};
                                             if((w4==j)){D1[i]=MinD[i];};
                                             if((w5==j)){E1[i]=MinE[i];};};};





var arr0=["A", "B", "C", "D", "E"];
var t='<table class="tab02"><tr>';
if(w1==5){t01=0;}else{t01='<th>'+arr0[0]+'</th>';}; 
if(w2==5){t02=0;}else{t02='<th>'+arr0[1]+'</th>';};
if(w3==5){t03=0;}else{t03='<th>'+arr0[2]+'</th>';}; 
if(w4==5){t04=0;}else{t04='<th>'+arr0[3]+'</th>';}; 
if(w5==5){t05=0;}else{t05='<th>'+arr0[4]+'</th>';}; 
t0='</tr>'; t+=t01+t02+t03+t04+t05+t0;
for (var i=0;i<dl;i++){
t00='<tr>';

if(w1==5){t001=0;}else{t001='<td>'+A1[i]+'</td>';}; 
if(w2==5){t002=0;}else{t002='<td>'+B1[i]+'</td>';};
if(w3==5){t003=0;}else{t003='<td>'+C1[i]+'</td>';}; 
if(w4==5){t004=0;}else{t004='<td>'+D1[i]+'</td>';}; 
if(w5==5){t005=0;}else{t005='<td>'+E1[i]+'</td>';}; 
t000='</tr>';
t+=t00+t001+t002+t003+t004+t005+t000;}
t+='</table>';
document.getElementById('res11').innerHTML=t;



};


</script>

</body>

</html>