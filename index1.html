<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="utf-8" />
        <title>Group_Table</title>
        <script type="text/javascript" src="jquery-1.10.0.min.js"></script>

<!--Стили таблиц и кнопок-->
<style type="text/css">
.tab01 {table-layout: fixed;
        width: 50%;
        border-collapse:collapse;
        background-color: #FFFF00;    
        font-size: 18pt;}
       
  .tab01 th {background-color: #DEB887;
         border:2px solid #000000;
         padding:0;
         width:200px;}
  .tab01 td {border:2px solid #000000;      
         padding:0;
         width:200px;}  
.tab01 td p {overflow: hidden;
         margin:0;
         padding:2px 4px;
}
.tab01 td p:focus {outline:1px solid #4D90FE;}
        
  .tab02 {table-layout: fixed;
         width:200px;
         border-collapse:collapse;
         background-color: #C0C0C0;    
         font-size: 18pt;
}
  .tab02 td,th {border:1px solid #000000;
         border-left:2px solid #000000;
         border-rigth:2px solid #000000;
         overflow: hidden;
         padding:0;
         width:200px;}

.tab03 {border-collapse:collapse;
         background-color: #DEB887;    
         font-size: 18pt;
         text-align: center;
         font-weight:bold}

  .tab03 td {border:1px solid #000000;
         border-top:2px solid #000000;
         border-left:2px solid #000000;
         border-rigth:2px solid #000000;          
         padding:0;
         width:200px;}

 .www {width: 200px;            
        font-size: 16pt;}  

 .sp01 {            
         font-size: 16pt;}    
 .sp02 {width:165px;            
         font-size: 13pt;}	
	  </style>   
</head>


<body>
<!--Таблица исходная--> 
<table id="myTable" class="tab01" >
  <tr>         <th>А</th>          <th>B</th>                  <th>C</th>                <th>D</th>              <th>E</th>       </tr>
  <tr> <td id="box1">100</td>   <td id="box2">40</td>   <td id="box3">10</td>     <td id="box4">1</td>    <td id="box5">20</td>   </tr>
  <tr> <td id="box6">100</td>   <td id="box7">41</td>   <td id="box8">11</td>     <td id="box9">2</td>    <td id="box10">21</td>  </tr>
  <tr> <td id="box11">300</td>  <td id="box12">42</td>  <td id="box13">12</td>     <td id="box14">3</td>   <td id="box15">22</td>  </tr>
  <tr> <td id="box16">400</td>  <td id="box17">43</td>  <td id="box18">13</td>     <td id="box19">4</td>   <td id="box20">23</td>  </tr>
  <tr> <td id="box21">500</td>  <td id="box22">44</td>  <td id="box23">14</td>     <td id="box24">5</td>   <td id="box25">24</td>  </tr>
  <tr> <td id="box26">600</td>  <td id="box27">45</td>  <td id="box28">15</td>     <td id="box29">6</td>   <td id="box30">25</td>  </tr>
  <tr> <td id="box31">700</td>  <td id="box32">46</td>  <td id="box33">16</td>     <td id="box34">7</td>   <td id="box35">26</td>  </tr>
  <tr> <td id="box36">800</td>  <td id="box37">47</td>  <td id="box38">17</td>     <td id="box39">8</td>   <td id="box40">27</td>  </tr>
  <tr> <td id="box41">900</td>  <td id="box42">48</td>  <td id="box43">18</td>     <td id="box44">9</td>   <td id="box45">28</td>  </tr>
  <tr> <td id="box46">1000</td>  <td id="box47">49</td>  <td id="box48">19</td>     <td id="box49">1</td>   <td id="box50">29</td>  </tr>
</table>




<!--Выпадающий список--> 
<form name="f1" class="sp01">
A:
<select name="Spisok A" id="s1" class="sp02">
  <option value="1">Сумма</option>
  <option value="2">Макс</option>
  <option value="3">Мин</option>
  <option value="4">Конкат</option>
  <option value="5">-----</option>
  <option value="6">Критер</option>
</select>


<form name="f2" class="sp01">
B:
<select name="Spisok B" id="s2" class="sp02">
  <option value="1">Сумма</option>
  <option value="2">Макс</option>
  <option value="3">Мин</option>
  <option value="4">Конкат</option>
  <option value="5">-----</option>
  <option value="6">Критер</option>
</select>


<form name="f3" class="sp01">
C:
<select name="Spisok C" id="s3" class="sp02">
  <option value="1">Сумма</option>
  <option value="2">Макс</option>
  <option value="3">Мин</option>
  <option value="4">Конкат</option>
  <option value="5">-----</option>
  <option value="6">Критер</option>
</select>


<form name="f4" class="sp01">
D:
<select name="Spisok D" id="s4" class="sp02">
  <option value="1">Сумма</option>
  <option value="2">Макс</option>
  <option value="3">Мин</option>
  <option value="4">Конкат</option>
  <option value="5">-----</option>
  <option value="6">Критер</option>
</select>


<form name="f5" class="sp01">
E:
<select name="Spisok E" id="s5" class="sp02">
  <option value="1">Сумма</option>
  <option value="2">Макс</option>
  <option value="3">Мин</option>
  <option value="4">Конкат</option>
  <option value="5">-----</option>
  <option value="6">Критер</option>
</select>


<!--Кнопка сгруппировать--> 
 <input type="button" onclick="Group1()" value="Сгруппировать"  id="1" class="www">
</form>

<!--Для итоговых таблиц--> 
<div id="res11"></div>

<!---Для коррект данных ячеек-->
<body onload="kor('myTable')">





<script language="javascript" type="text/javascript">

<!---Функция коррект данных ячеек-->
function kor(znach) 
{
  var tbl = document.getElementById(znach);
  for (i=1; i<tbl.rows.length; i++) 
{
    var row = tbl.rows[i];
    for (j=0; j<row.cells.length; j++)
 {
      var td = row.cells[i,j];
      td.innerHTML = '<p tabindex="-1" contenteditable="true">' + td.innerHTML + '</p>';
    }
  }
}




<!---Функция по нажатию кнопки-->
function Group1() 
{

<!--Забираем значения ячеек из исходной таблицы--> 
var a1= document.getElementById("box1").innerText;   var b1= document.getElementById("box2").innerText;   var c1= document.getElementById("box3").innerText;   var d1= document.getElementById("box4").innerText;   var e1= document.getElementById("box5").innerText;
var a2= document.getElementById("box6").innerText;   var b2= document.getElementById("box7").innerText;   var c2= document.getElementById("box8").innerText;   var d2= document.getElementById("box9").innerText;   var e2= document.getElementById("box10").innerText;
var a3= document.getElementById("box11").innerText;  var b3= document.getElementById("box12").innerText;  var c3= document.getElementById("box13").innerText;  var d3= document.getElementById("box14").innerText;  var e3= document.getElementById("box15").innerText;
var a4= document.getElementById("box16").innerText;  var b4= document.getElementById("box17").innerText;  var c4= document.getElementById("box18").innerText;  var d4= document.getElementById("box19").innerText;  var e4= document.getElementById("box20").innerText;
var a5= document.getElementById("box21").innerText;  var b5= document.getElementById("box22").innerText;  var c5= document.getElementById("box23").innerText;  var d5= document.getElementById("box24").innerText;  var e5= document.getElementById("box25").innerText;
var a6= document.getElementById("box26").innerText;  var b6= document.getElementById("box27").innerText;  var c6= document.getElementById("box28").innerText;  var d6= document.getElementById("box29").innerText;  var e6= document.getElementById("box30").innerText;
var a7= document.getElementById("box31").innerText;  var b7= document.getElementById("box32").innerText;  var c7= document.getElementById("box33").innerText;  var d7= document.getElementById("box34").innerText;  var e7= document.getElementById("box35").innerText;
var a8= document.getElementById("box36").innerText;  var b8= document.getElementById("box37").innerText;  var c8= document.getElementById("box38").innerText;  var d8= document.getElementById("box39").innerText;  var e8= document.getElementById("box40").innerText;
var a9= document.getElementById("box41").innerText;  var b9= document.getElementById("box42").innerText;  var c9= document.getElementById("box43").innerText;  var d9= document.getElementById("box44").innerText;  var e9= document.getElementById("box45").innerText;
var a10= document.getElementById("box46").innerText; var b10= document.getElementById("box47").innerText; var c10= document.getElementById("box48").innerText; var d10= document.getElementById("box49").innerText; var e10= document.getElementById("box50").innerText;

<!--Забираем значения селекторов--> 
var w1=document.getElementById('s1').value;
var w2=document.getElementById('s2').value;
var w3=document.getElementById('s3').value;
var w4=document.getElementById('s4').value;
var w5=document.getElementById('s5').value;

	

if (  (  (/[^[0-9]/.test(a1)) || (/[^[0-9]/.test(a2))  || (/[^[0-9]/.test(a3)) || (/[^[0-9]/.test(a4)) || (/[^[0-9]/.test(a5)) || (/[^[0-9]/.test(a6))  || (/[^[0-9]/.test(a7))  || (/[^[0-9]/.test(a8))  || (/[^[0-9]/.test(a9)) || (/[^[0-9]/.test(a10))  ) &&   ((w1 == 1) || (w1 == 2) || (w1 == 3))  ){alert('В столбец А не введено число');}
if (  (  (/[^[0-9]/.test(b1)) || (/[^[0-9]/.test(b2))  || (/[^[0-9]/.test(b3)) || (/[^[0-9]/.test(b4)) || (/[^[0-9]/.test(b5)) || (/[^[0-9]/.test(b6))  || (/[^[0-9]/.test(b7))  || (/[^[0-9]/.test(b8))  || (/[^[0-9]/.test(b9)) || (/[^[0-9]/.test(b10))  ) &&   ((w2 == 1) || (w2 == 2) || (w2 == 3))  ){alert('В столбец B не введено число');}
if (  (  (/[^[0-9]/.test(c1)) || (/[^[0-9]/.test(c2))  || (/[^[0-9]/.test(c3)) || (/[^[0-9]/.test(c4)) || (/[^[0-9]/.test(c5)) || (/[^[0-9]/.test(c6))  || (/[^[0-9]/.test(c7))  || (/[^[0-9]/.test(c8))  || (/[^[0-9]/.test(c9)) || (/[^[0-9]/.test(c10))  ) &&   ((w3 == 1) || (w3 == 2) || (w3 == 3))  ){alert('В столбец C не введено число');}
if (  (  (/[^[0-9]/.test(d1)) || (/[^[0-9]/.test(d2))  || (/[^[0-9]/.test(d3)) || (/[^[0-9]/.test(d4)) || (/[^[0-9]/.test(d5)) || (/[^[0-9]/.test(d6))  || (/[^[0-9]/.test(d7))  || (/[^[0-9]/.test(d8))  || (/[^[0-9]/.test(d9)) || (/[^[0-9]/.test(d10))  ) &&   ((w4 == 1) || (w4 == 2) || (w4 == 3))  ){alert('В столбец D не введено число');}
if (  (  (/[^[0-9]/.test(e1)) || (/[^[0-9]/.test(e2))  || (/[^[0-9]/.test(e3)) || (/[^[0-9]/.test(e4)) || (/[^[0-9]/.test(e5)) || (/[^[0-9]/.test(e6))  || (/[^[0-9]/.test(e7))  || (/[^[0-9]/.test(e8))  || (/[^[0-9]/.test(e9)) || (/[^[0-9]/.test(e10))  ) &&   ((w5 == 1) || (w5 == 2) || (w5 == 3))  ){alert('В столбец E не введено число');}


if ((w1 == 1) || (w1 == 2) || (w1 == 3)) {a1= +a1; a2= +a2; a3= +a3; a4= +a4; a5= +a5; a6= +a6; a7= +a7; a8= +a8; a9= +a9; a10= +a10;} 
if ((w2 == 1) || (w2 == 2) || (w2 == 3)) {b1= +b1; b2= +b2; b3= +b3; b4= +b4; b5= +b5; b6= +b6; b7= +b7; b8= +b8; b9= +b9; b10= +b10;}
if ((w3 == 1) || (w3 == 2) || (w3 == 3)) {c1= +c1; c2= +c2; c3= +c3; c4= +c4; c5= +c5; c6= +c6; c7= +c7; c8= +c8; c9= +c9; c10= +c10;}
if ((w4 == 1) || (w4 == 2) || (w4 == 3)) {d1= +d1; d2= +d2; d3= +d3; d4= +d4; d5= +d5; d6= +d6; d7= +d7; d8= +d8; d9= +d9; d10= +d10;}
if ((w5 == 1) || (w5 == 2) || (w5 == 3)) {e1= +e1; e2= +e2; e3= +e3; e4= +e4; e5= +e5; e6= +e6; e7= +e7; e8= +e8; e9= +e9; e10= +e10;}


var ar1=[a1, a2, a3, a4, a5, a6, a7, a8, a9, a10];
var ar2=[b1, b2, b3, b4, b5, b6, b7, b8, b9, b10];
var ar3=[c1, c2, c3, c4, c5, c6, c7, c8, c9, c10];
var ar4=[d1, d2, d3, d4, d5, d6, d7, d8, d9, d10];
var ar5=[e1, e2, e3, e4, e5, e6, e7, e8, e9, e10];

if ((w1 != 6) && (w2 != 6) && (w3 != 6) && (w4 != 6) && (w5 != 6)) {xr1=0; alert("Выберите критерий!")} else {xr1=1};

if (xr1 == 1){ 
<!--Группировка, например, n строк по 5 критериям (правда, без мах,мин просто идея с функцией уникального элемента)  -->
var n = ar1.length, k1 = 0, A1 = [], B1 = [], C1 = [], D1 = [], E1 = [], k2 = 0, k3 = 0, k4 = 0, k5 = 0; SumA = [];SumB = [];SumC = [];SumD = [];SumE = [];
MaxA = [];MaxB = [];MaxC = [];MaxD = [];MaxE = []; MinA = [];MinB = [];MinC = [];MinD = [];MinE = [];
    for (var i = 0; i < n; i++) { var j = 0; 
                                  while ((j < k1) &&
                                        ( (A1[j] !== ar1[ i ])&&(w1==6) ||
                                          (B1[j] !== ar2[ i ])&&(w2==6) ||
                                          (C1[j] !== ar3[ i ])&&(w3==6) ||
                                          (D1[j] !== ar4[ i ])&&(w4==6) ||
                                          (E1[j] !== ar5[ i ])&&(w5==6)   )){j++;}; 

if ( ((w1==1)||(w1==4))&&
              (
               (  B1[j] !== ar2[ i ]&&(w2==6)||(w2!=6)  ) && 
               (  C1[j] !== ar3[ i ]&&(w3==6)||(w3!=6)  ) &&
               (  D1[j] !== ar4[ i ]&&(w4==6)||(w4!=6)  ) &&
               (  E1[j] !== ar5[ i ]&&(w5==6)||(w5!=6)  )
               )                                   
   ){SumA[j] = ar1[ i ];} else {SumA[j] = SumA[j]+ar1[ i ];}
 

if ( ((w2==1)||(w2==4))&&
              (
               (  A1[j] !== ar1[ i ]&&(w1==6)||(w1!=6)  ) && 
               (  C1[j] !== ar3[ i ]&&(w3==6)||(w3!=6)  ) &&
               (  D1[j] !== ar4[ i ]&&(w4==6)||(w4!=6)  ) &&
               (  E1[j] !== ar5[ i ]&&(w5==6)||(w5!=6)  )
               )                                   
   ){SumB[j] = ar2[ i ];} else {SumB[j] = SumB[j]+ar2[ i ];}



if ( ((w3==1)||(w3==4))&&
              (
               (  A1[j] !== ar1[ i ]&&(w1==6)||(w1!=6)  ) && 
               (  B1[j] !== ar2[ i ]&&(w2==6)||(w2!=6)  ) &&
               (  D1[j] !== ar4[ i ]&&(w4==6)||(w4!=6)  ) &&
               (  E1[j] !== ar5[ i ]&&(w5==6)||(w5!=6)  )
               )                                   
   ){SumC[j] = ar3[ i ];} else {SumC[j] = SumC[j]+ar3[ i ];}


if ( ((w4==1)||(w4==4))&&
              (
               (  A1[j] !== ar1[ i ]&&(w1==6)||(w1!=6)  ) && 
               (  B1[j] !== ar2[ i ]&&(w2==6)||(w2!=6)  ) &&
               (  C1[j] !== ar3[ i ]&&(w3==6)||(w3!=6)  ) &&
               (  E1[j] !== ar5[ i ]&&(w5==6)||(w5!=6)  )
               )                                   
   ){SumD[j] = ar4[ i ];} else {SumD[j] = SumD[j]+ar4[ i ];}


if ( ((w5==1)||(w5==4))&&
              (
               (  A1[j] !== ar1[ i ]&&(w1==6)||(w1!=6)  ) && 
               (  B1[j] !== ar2[ i ]&&(w2==6)||(w2!=6)  ) &&
               (  C1[j] !== ar3[ i ]&&(w3==6)||(w3!=6)  ) &&
               (  D1[j] !== ar4[ i ]&&(w4==6)||(w4!=6)  )
               )                                   
   ){SumE[j] = ar5[ i ];} else {SumE[j] = SumE[j]+ar5[ i ];}












if (j == k1) {A1[k1++] = ar1[ i ];
              B1[k2++] = ar2[ i ];
              C1[k3++] = ar3[ i ];
              D1[k4++] = ar4[ i ];
              E1[k5++] = ar5[ i ];}; };};

   
for (var i=0;i<A1.length;i++){
                              for (var j=1;j<2;j++){ if((w1==j)||(w1==4)){A1[i]=SumA[i];};
                                                     if((w2==j)||(w2==4)){B1[i]=SumB[i];};
                                                     if((w3==j)||(w3==4)){C1[i]=SumC[i];};
                                                     if((w4==j)||(w5==4)){D1[i]=SumD[i];};
                                                     if((w5==j)||(w6==4)){E1[i]=SumE[i];};
                                                    };
                               };


var t='<table class="tab02"><tr><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th></tr>';
for (var i=0;i<A1.length;i++){t+='<tr><td>'+A1[i]+'</td><td>'+B1[i]+'</td><td>'+C1[i]+'</td><td>'+D1[i]+'</td><td>'+E1[i]+'</td></tr>' ;}
t+='</table>';
document.getElementById('res11').innerHTML=t;

};


</script>

</body>

</html>